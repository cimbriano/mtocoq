\documentclass[10pt,  onecolumn]{article}
\usepackage{enumerate}
\usepackage{url}

% To put a border around figures
\usepackage{ mdframed }


% To use inline teletype command \texttt{}
\usepackage{courier}

%To use \citeauthor
\usepackage[numbers]{natbib}

% For using the listings package (to write code)
\usepackage{listings}
\usepackage{color}

\lstset{ %
	backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
	basicstyle=\footnotesize,        % the size of the fonts that are used for the code
	breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
	breaklines=true,                 % sets automatic line breaking
	captionpos=b,                    % sets the caption-position to bottom
	deletekeywords={...},            % if you want to delete keywords from the given language
	escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
	extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
	frame=single,                    % adds a frame around the code
	keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
	keywordstyle=\color{blue},       % keyword style
	language=ML,                 % the language of the code
	morekeywords={*,...},            % if you want to add more keywords to the set
	numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
	numbersep=5pt,                   % how far the line-numbers are from the code
	rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
	showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
	showstringspaces=false,          % underline spaces within strings only
	showtabs=false,                  % show tabs within strings adding particular underscores
	stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
	tabsize=2,                       % sets default tabsize to 2 spaces
	title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}



\begin{document}

\title{Coq Formalization of Memory Trace Oblivious Execution}
\author{ Chris Imbriano, Andrew Lohr \\
\{imbriano,  alohr1\}@umd.edu }
\date{May 2013}

\maketitle

% General Notes
%Your write up should be 5-15 pages, as necessary.


\begin{abstract}
% Summarizing your motivation and your accomplishments.
In a traditional security model, known as non-interference, a program's inputs and outputs are given security labels indicating that data's sensitivity; \emph{low} and \emph{high}.
\emph{Low} variables are those data that are public or can be infrared from publicly available information, whereas \emph{high} variables are secret or private data.
The non-interference model seeks to maintain the secrecy of \emph{high} variables by ensuring that all program executions with identical \emph{low} (public) inputs produce the same \emph{low} outputs.

While non-interference is a strong security model in theory, in practice real executing programs "leak" information about its data through a number of channels - timing, electromagnetic radiation, power consumption, and execution trace, to name a few.
\citeauthor{mtope} presented a type system to efficiently address information leakage via a program execution trace.
The proofs presented by \citeauthor{mtope} are presented in human-readable format but lack a corresponding proof certificate from verified proof assistant.

We present the foundation necessary to implement and verify the proofs by \citeauthor{mtope}.
In section \emph{SECTION LABEL}, we outline our approach.
In section \emph{SECTION LABEL}, we discuss challenges both technical and not.
\emph{FLESH THIS PART OUT}

\end{abstract}

\section{Introduction}
\label{sec:introduction}
% Summarizing your motivation and your accomplishments.


\section {Overview}
% The intermediate sections should contain full details about what you did.

We will begin by giving an overview of the Coq project files and the contents within each.
It will be assumed that the reader is familiar with the definitions and concepts presented in \emph{Memory Trace Oblivious Program Execution} (MTOPE).
Then, we will describe in more detail each file's contents with emphasis on definitions which differ substantially from those provided in the paper.


\section{ Project Structure }

% Include a section? Sflib, strong induction technique?
%	\subsection{ External Requirements }


% TODO Maybe these shouldn't be subsections, but some form of list instead?
	\subsection{ Core Definitions }
	The foundation of our definitions are found in a file called core.v.
	Here is where we define all structures common to that will be used in downstream definitions.
	For the most part the definitions here follow one-to-one from those in the paper, however the definition of statement required special handling.

	Below we reproduce the relevant definitions from the paper and our Coq definitions.


\begin{figure}
\caption{ MTPOE definitions for Statements and Programs }
\label{fig:mto_rule_while}

	\begin{mdframed}
	Numbers $n \in \textbf{Nat}$\\
	ORAM bank $o \in \textbf{ORAMbank}$\\
	Locations $p ::= n | o$\\
	Statements $ s ::= skip | x := e | x[e] := e | if(e, S, S) | while(e, S)$\\
	Programs $ S ::= p:s | S;S$
	\end{mdframed}

\end{figure}

\begin{figure}
\caption{ Typing Judgement for statements : while}
\label{fig:while_judgement}
\[
\frac{ \Gamma \vdash e : Nat \; l; T_{1}   \;\;\;\;  \Gamma, l_{0} \vdash S;T_{2}  \;\;\;\;   l \sqcup l_{0} \sqsubseteq L }
	{ \Gamma, l_{0} \vdash p:\textbf{while}(e,S);\textbf{Loop}(p,T_{1},T_{2}) }
\]
\end{figure}

\begin{figure}
\caption{Coq definitions for statements, programs and labeled statements}
\label{fig:coq_statements}
\begin{lstlisting}
Inductive statement : Type :=
  | skip : statement
  | assign: variable -> expression -> statement
  | arrassign: variable -> expression -> expression -> statement
  | stif: expression -> program -> program -> statement
  | stwhile: expression -> program -> statement

with labeledstatement : Type :=
  | labline : location -> statement -> labeledstatement

with program : Type :=
  | oneLineProg : labeledstatement -> program
  | progcat : program -> program -> program.
\end{lstlisting}
\end{figure}



Figure \ref{fig:while_judgement} shows the typing rule for a \texttt{while} statement.
Notice that even though figure \ref{fig:mto_rule_while} shows the definition of a while statement to be without a location, ie. \texttt{while(e,S)}, the typing judgement for statements types a while statement augmented with a location \texttt{p:while(e,S)}, which is structurally a "Program".
The typing rule requires this information since the type of trace pattern produced depends on a while statements label.
For this reason, we define \texttt{statement} in Coq to be analogous to the paper's definition, but we introduce a labeled statement.
Doing this further requires writing the typing rules in terms of labeled statements, rather than plain statements as is done by the paper.

Another deviation from the paper's definitions is in the implementation of the operator $\sqsubseteq$.
In all but one case, this operator compares two security labels, each of which can be either $L$ or an Oram Bank number - definition shown in figure \ref{fig:mto_labeldef}.
However, in the typing rule for, what the paper refers to as, a labeled statement one of the premises abuses the $\sqsubseteq$ operator by comparing a label, $l_{0}$ to a location. The rule is shown in figure \ref{fig:mto_rule_statement}

\begin{figure}
\caption{Formal definition for Labels}
\label{fig:mto_labeldef}
	\begin{mdframed}
	Labels $l \in \textbf{SecLabels} = \{L\} \cup \textbf{ORAMbanks}$
	\end{mdframed}
\end{figure}

\begin{figure}
\caption{ Typing rule for labeled statements under the judgment for Programs}
\label{fig:mto_rule_statement}
\[
\frac{ \Gamma, l_{0} \vdash s;T \;\;\; l_{0} \sqsubseteq p }
	{ \Gamma, l_{0} \vdash p:s;(\textbf{Fetch} p)@T}
\]
\end{figure}

\begin{figure}
\caption{ Coq definition of the $\sqsubseteq$ operator }
\label{fig:coq_label_le}
\begin{lstlisting}
Inductive label_le : label -> label -> Prop :=
  | fst_low : forall   l, label_le low l
  | snd_high: forall l n, label_le l   (o_high n).

Inductive label_le_rhslocation : label -> location -> Prop :=
  | highloc : forall l n, label_le_rhslocation l   (oram n)
  | lowlab  : forall   p, label_le_rhslocation low p.
\end{lstlisting}

\end{figure}

Figure \ref{coq_label_le} shows our proposed implementation of this operator.
We essentially have two versions of the $\sqsubseteq$ relation, one which is the expected operation of comparing two security labels, and the other of which compares a label to a location.




\subsection{ Typing Judgements }












	\subsection{ Operational Semantics }
	\subsection{ Lemmas and Proofs }

% Proofs were written by humans for humans.
% Many times there we're "abuses of notation", "lemma 5 is proved using a similar technique as lemma 4"
	% which resulted in requiring more infrastructure/definitions than we initially envisioned


%- Duplication in definitions, lemmas, proofs for traces and trace patterns
%
%- Choosing to represent trace equivalence and trace pattern equivalence as Relations instead of functions (because they're only used in a relational way)
%
%- Handling of arrays
%	* Will this constrain extending the type system to allow each element of an array to occupy its own OramBank?
%
%- Many variables to keep track of.
%	* A lot of quantified variables in the statement of the theorem

\section{Related Work}
\label{sec:relatedwork}
% Research papers should also include a related work section.

\section{Conclusion}
\label{sec:conclusion}
% End with a conclusion putting the project in perspective and mentioning open problems


%Issues/Difficulties/Notes
%
%- Duplication in definitions, lemmas, proofs for traces and trace patterns
%
%- Choosing to represent trace equivalence and trace pattern equivalence as Relations instead of functions (because they're only used in a relational way)
\cite{mtope}
\cite{sf}
\cite{techreport}


\bibliographystyle{plainnat}
\bibliography{report}


%\begin{thebibliography}{9}
%% bibliography of cited papers.
%	\bibitem{itemname} aaaaaaaaaaaa
%\end{thebibliography}

\end{document}